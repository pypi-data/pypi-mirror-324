"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["79542"],{50875:function(e,t,i){i.d(t,{Eu:()=>n,hZ:()=>s,o9:()=>d});var o=i(27486),a=i(11259);const r=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function n(e){return r[e%r.length]}function s(e,t){const i=t.getPropertyValue(`--graph-color-${e+1}`)||n(e);return(0,a.Rq)(i)}const d=(0,o.Z)((e=>r.map(((t,i)=>s(i,e)))),((e,t)=>e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1")))},25179:function(e,t,i){i.a(e,(async function(e,o){try{i.d(t,{Q:()=>x});var a=i(61701),r=i(72621),n=(i(71695),i(92745),i(19423),i(40251),i(39527),i(41360),i(47021),i(57243)),s=i(50778),d=i(69634),l=i(18672),c=i(60738),h=i(36522),u=i(94134),v=(i(23334),i(62201)),f=i(30635),p=i(50875),y=e([l]);l=(y.then?(await y)():y)[0];let m,g,k,b=e=>e;const _="M12,4C14.1,4 16.1,4.8 17.6,6.3C20.7,9.4 20.7,14.5 17.6,17.6C15.8,19.5 13.3,20.2 10.9,19.9L11.4,17.9C13.1,18.1 14.9,17.5 16.2,16.2C18.5,13.9 18.5,10.1 16.2,7.7C15.1,6.6 13.5,6 12,6V10.6L7,5.6L12,0.6V4M6.3,17.6C3.7,15 3.3,11 5.1,7.9L6.6,9.4C5.5,11.6 5.9,14.4 7.8,16.2C8.3,16.7 8.9,17.1 9.6,17.4L9,19.4C8,19 7.1,18.4 6.3,17.6Z",x=3e5;(0,a.Z)([(0,s.Mo)("ha-chart-base")],(function(e,t){class o extends t{constructor(...t){super(...t),e(this)}}return{F:o,d:[{kind:"field",key:"chart",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"data",value(){return[]}},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"options",value:void 0},{kind:"field",decorators:[(0,s.Cb)({type:String})],key:"height",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:"external-hidden",type:Boolean})],key:"externalHidden",value(){return!1}},{kind:"field",decorators:[(0,s.SB)(),(0,c.F_)({context:f.LW,subscribe:!0})],key:"_themes",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_isZoomed",value(){return!1}},{kind:"field",key:"_modifierPressed",value(){return!1}},{kind:"field",key:"_isTouchDevice",value(){return"ontouchstart"in window}},{kind:"field",key:"_resizeController",value(){return new l.Z(this,{callback:()=>{var e;return null===(e=this.chart)||void 0===e?void 0:e.resize()}})}},{kind:"field",key:"_loading",value(){return!1}},{kind:"field",key:"_reducedMotion",value(){return!1}},{kind:"field",key:"_listeners",value(){return[]}},{kind:"method",key:"disconnectedCallback",value:function(){var e;for((0,r.Z)(o,"disconnectedCallback",this,3)([]);this._listeners.length;)this._listeners.pop()();null===(e=this.chart)||void 0===e||e.dispose()}},{kind:"method",key:"connectedCallback",value:function(){(0,r.Z)(o,"connectedCallback",this,3)([]),this.hasUpdated&&this._setupChart(),this._listeners.push((0,v.K)("(prefers-reduced-motion)",(e=>{var t;this._reducedMotion=e,null===(t=this.chart)||void 0===t||t.setOption({animation:!this._reducedMotion})})));const e=e=>{var t,i;(u.V&&e.metaKey||!u.V&&e.ctrlKey)&&(this._modifierPressed=!0,null!==(t=this.options)&&void 0!==t&&t.dataZoom||null===(i=this.chart)||void 0===i||i.setOption({dataZoom:this._getDataZoomConfig()}))},t=e=>{var t,i;(u.V&&"Meta"===e.key||!u.V&&"Control"===e.key)&&(this._modifierPressed=!1,null!==(t=this.options)&&void 0!==t&&t.dataZoom||null===(i=this.chart)||void 0===i||i.setOption({dataZoom:this._getDataZoomConfig()}))};window.addEventListener("keydown",e),window.addEventListener("keyup",t),this._listeners.push((()=>window.removeEventListener("keydown",e)),(()=>window.removeEventListener("keyup",t)))}},{kind:"method",key:"firstUpdated",value:function(){this._setupChart()}},{kind:"method",key:"willUpdate",value:function(e){(0,r.Z)(o,"willUpdate",this,3)([e]),this.hasUpdated&&this.chart&&(e.has("_themes")?this._setupChart():(e.has("data")&&this.chart.setOption({series:this.data},{lazyUpdate:!0,replaceMerge:["series"]}),(e.has("options")||e.has("_isZoomed"))&&this.chart.setOption(this._createOptions(),{lazyUpdate:!0,replaceMerge:["xAxis","yAxis","dataZoom","dataset","tooltip","grid","visualMap"]})))}},{kind:"method",key:"render",value:function(){var e;return(0,n.dy)(m||(m=b` <div class="chart-container" style="${0}" @wheel="${0}"> <div class="chart"></div> ${0} </div> `),(0,d.V)({height:null!==(e=this.height)&&void 0!==e?e:`${this._getDefaultHeight()}px`}),this._handleWheel,this._isZoomed?(0,n.dy)(g||(g=b`<ha-icon-button class="zoom-reset" .path="${0}" @click="${0}" title="${0}"></ha-icon-button>`),_,this._handleZoomReset,this.hass.localize("ui.components.history_charts.zoom_reset")):n.Ld)}},{kind:"method",key:"_setupChart",value:async function(){if(this._loading)return;const e=this.renderRoot.querySelector(".chart");this._loading=!0;try{this.chart&&this.chart.dispose();const t=(await Promise.all([i.e("79525"),i.e("58884"),i.e("42974")]).then(i.bind(i,85803))).default;t.registerTheme("custom",this._createTheme()),this.chart=t.init(e,"custom"),this.chart.on("legendselectchanged",(e=>{if(this.externalHidden){e.selected[e.name]?(0,h.B)(this,"dataset-unhidden",{name:e.name}):(0,h.B)(this,"dataset-hidden",{name:e.name})}})),this.chart.on("datazoom",(e=>{var t,i;const{start:o,end:a}=null!==(t=null===(i=e.batch)||void 0===i?void 0:i[0])&&void 0!==t?t:e;this._isZoomed=0!==o||100!==a})),this.chart.on("click",(e=>{(0,h.B)(this,"chart-click",e)})),this.chart.on("mousemove",(e=>{var t;"series"===e.componentType&&"custom"===e.componentSubType&&(null===(t=this.chart)||void 0===t||null===(t=t.getZr())||void 0===t||t.setCursorStyle("default"))})),this.chart.setOption(Object.assign(Object.assign({},this._createOptions()),{},{series:this.data}))}finally{this._loading=!1}}},{kind:"method",key:"_getDataZoomConfig",value:function(){var e,t,i,o,a,r;const n=null!==(e=null===(t=this.options)||void 0===t||null===(t=t.xAxis)||void 0===t?void 0:t[0])&&void 0!==e?e:null===(i=this.options)||void 0===i?void 0:i.xAxis,s=null!==(o=null===(a=this.options)||void 0===a||null===(a=a.yAxis)||void 0===a?void 0:a[0])&&void 0!==o?o:null===(r=this.options)||void 0===r?void 0:r.yAxis;if("value"!==n.type||"category"!==s.type)return{id:"dataZoom",type:"inside",orient:"horizontal",filterMode:"none",moveOnMouseMove:this._isZoomed,preventDefaultMouseMove:this._isZoomed,zoomLock:!this._isTouchDevice&&!this._modifierPressed}}},{kind:"method",key:"_createOptions",value:function(){var e;const t=Object.assign({animation:!this._reducedMotion,darkMode:null!==(e=this._themes.darkMode)&&void 0!==e&&e,aria:{show:!0},dataZoom:this._getDataZoomConfig()},this.options);if(window.matchMedia("all and (max-width: 450px), all and (max-height: 500px)").matches&&t.tooltip){const e=Array.isArray(t.tooltip)?t.tooltip:[t.tooltip];e.forEach((e=>{e.confine=!0,e.appendTo=void 0})),t.tooltip=e}return t}},{kind:"method",key:"_createTheme",value:function(){const e=getComputedStyle(this);return{color:(0,p.o9)(e),backgroundColor:"transparent",textStyle:{color:e.getPropertyValue("--primary-text-color")},title:{textStyle:{color:e.getPropertyValue("--primary-text-color")},subtextStyle:{color:e.getPropertyValue("--secondary-text-color")}},line:{lineStyle:{width:1.5},symbolSize:1,symbol:"circle",smooth:!1},bar:{itemStyle:{barBorderWidth:1.5}},categoryAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!0,color:e.getPropertyValue("--primary-text-color")},splitLine:{show:!1,lineStyle:{color:e.getPropertyValue("--divider-color")}},splitArea:{show:!1,areaStyle:{color:[e.getPropertyValue("--divider-color")+"3F",e.getPropertyValue("--divider-color")+"7F"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:e.getPropertyValue("--divider-color")}},axisTick:{show:!0,lineStyle:{color:e.getPropertyValue("--divider-color")}},axisLabel:{show:!0,color:e.getPropertyValue("--primary-text-color")},splitLine:{show:!0,lineStyle:{color:e.getPropertyValue("--divider-color")}},splitArea:{show:!1,areaStyle:{color:[e.getPropertyValue("--divider-color")+"3F",e.getPropertyValue("--divider-color")+"7F"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:e.getPropertyValue("--divider-color")}},axisTick:{show:!0,lineStyle:{color:e.getPropertyValue("--divider-color")}},axisLabel:{show:!0,color:e.getPropertyValue("--primary-text-color")},splitLine:{show:!0,lineStyle:{color:e.getPropertyValue("--divider-color")}},splitArea:{show:!1,areaStyle:{color:[e.getPropertyValue("--divider-color")+"3F",e.getPropertyValue("--divider-color")+"7F"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:e.getPropertyValue("--divider-color")}},axisTick:{show:!0,lineStyle:{color:e.getPropertyValue("--divider-color")}},axisLabel:{show:!0,color:e.getPropertyValue("--primary-text-color")},splitLine:{show:!0,lineStyle:{color:e.getPropertyValue("--divider-color")}},splitArea:{show:!1,areaStyle:{color:[e.getPropertyValue("--divider-color")+"3F",e.getPropertyValue("--divider-color")+"7F"]}}},legend:{textStyle:{color:e.getPropertyValue("--primary-text-color")},inactiveColor:e.getPropertyValue("--disabled-text-color")},tooltip:{axisPointer:{lineStyle:{color:e.getPropertyValue("--divider-color")},crossStyle:{color:e.getPropertyValue("--divider-color")}}},timeline:{}}}},{kind:"method",key:"_getDefaultHeight",value:function(){return Math.max(this.clientWidth/2,300)}},{kind:"method",key:"_handleZoomReset",value:function(){var e;null===(e=this.chart)||void 0===e||e.dispatchAction({type:"dataZoom",start:0,end:100})}},{kind:"method",key:"_handleWheel",value:function(e){var t;if(null===(t=this.options)||void 0===t||!t.dataZoom){const t=u.V&&e.metaKey||!u.V&&e.ctrlKey;var i;if(t&&e.preventDefault(),t!==this._modifierPressed)this._modifierPressed=t,null===(i=this.chart)||void 0===i||i.setOption({dataZoom:this._getDataZoomConfig()})}}},{kind:"field",static:!0,key:"styles",value(){return(0,n.iv)(k||(k=b`:host{display:block;position:relative}.chart-container{position:relative;max-height:var(--chart-max-height,300px)}.chart{width:100%;height:100%}.zoom-reset{position:absolute;top:16px;right:4px;background:var(--card-background-color);border-radius:4px;--mdc-icon-button-size:32px;color:var(--primary-color);border:1px solid var(--divider-color)}`))}}]}}),n.oi);o()}catch(m){o(m)}}))},6736:function(e,t,i){i.d(t,{f:()=>n});var o=i(61701),a=i(72621),r=(i(19083),i(71695),i(40251),i(61006),i(39527),i(36993),i(47021),i(50778));const n=e=>(0,o.Z)(null,(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,r.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,a.Z)(i,"connectedCallback",this,3)([]),this._checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,a.Z)(i,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){const e=this.__unsubs.pop();e instanceof Promise?e.then((e=>e())):e()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(e){if((0,a.Z)(i,"updated",this,3)([e]),e.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const t of e.keys())if(this.hassSubscribeRequiredHostProps.includes(t))return void this._checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"_checkSubscribed",value:function(){var e;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(e=this.hassSubscribeRequiredHostProps)&&void 0!==e&&e.some((e=>void 0===this[e]))||(this.__unsubs=this.hassSubscribe())}}]}}),e)},18709:function(e,t,i){i.a(e,(async function(e,o){try{i.r(t),i.d(t,{HuiEnergyDevicesGraphCard:()=>x});var a=i(61701),r=(i(71695),i(92745),i(61893),i(40251),i(39527),i(67670),i(41360),i(13334),i(47021),i(57243)),n=i(50778),s=i(35359),d=i(27486),l=i(50875),c=i(50602),h=i(25179),u=i(1118),v=i(17705),f=i(6736),p=i(93331),y=(i(54977),i(36522)),m=e([h,u,c]);[h,u,c]=m.then?(await m)():m;let g,k,b,_=e=>e,x=(0,a.Z)([(0,n.Mo)("hui-energy-devices-graph-card")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,n.SB)()],key:"_chartData",value(){return[]}},{kind:"field",decorators:[(0,n.SB)()],key:"_data",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var e;return[(0,u.UB)(this.hass,{key:null===(e=this._config)||void 0===e?void 0:e.collection_key}).subscribe((e=>{this._data=e,this._getStatistics(e)}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(e){this._config=e}},{kind:"method",key:"shouldUpdate",value:function(e){return(0,p.SN)(this,e)||e.size>1||!e.has("hass")}},{kind:"method",key:"render",value:function(){var e;return this.hass&&this._config?(0,r.dy)(g||(g=_` <ha-card> ${0} <div class="content ${0}"> <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" .height="${0}" @chart-click="${0}"></ha-chart-base> </div> </ha-card> `),this._config.title?(0,r.dy)(k||(k=_`<h1 class="card-header">${0}</h1>`),this._config.title):"",(0,s.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._chartData),28*((null===(e=this._chartData[0])||void 0===e||null===(e=e.data)||void 0===e?void 0:e.length)||0)+50+"px",this._handleChartClick):r.Ld}},{kind:"method",key:"_renderTooltip",value:function(e){const t=`<h4 style="text-align: center; margin: 0;">${this._getDeviceName(e.value[1])}</h4>`,i=`${(0,c.uf)(e.value[0],this.hass.locale,(0,c.l4)(void 0,this.hass.entities[e.value[1]]))} kWh`;return`${t}${e.marker} ${e.seriesName}: ${i}`}},{kind:"field",key:"_createOptions",value(){return(0,d.Z)((e=>{var t;return{xAxis:{type:"value",name:"kWh"},yAxis:{type:"category",inverse:!0,triggerEvent:!0,data:null===(t=e[0])||void 0===t||null===(t=t.data)||void 0===t?void 0:t.map((e=>e.value[1])),axisLabel:{formatter:this._getDeviceName.bind(this),overflow:"truncate"}},grid:{top:5,left:5,right:40,bottom:0,containLabel:!0},tooltip:{show:!0,formatter:this._renderTooltip.bind(this)}}}))}},{kind:"method",key:"_getDeviceName",value:function(e){var t,i;return(null===(t=this._data)||void 0===t||null===(t=t.prefs.device_consumption.find((t=>t.stat_consumption===e)))||void 0===t?void 0:t.name)||(0,v.Kd)(this.hass,e,null===(i=this._data)||void 0===i?void 0:i.statsMetadata[e])}},{kind:"method",key:"_getStatistics",value:async function(e){var t;const i=e.stats,o=e.statsCompare,a=[],r=[],n=[{type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:a,barWidth:o?10:20,cursor:"default"}];o&&n.push({type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.previous_energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:r,barWidth:10,cursor:"default"});const s=getComputedStyle(this);e.prefs.device_consumption.forEach(((e,t)=>{const n=e.stat_consumption in i&&(0,v.Kj)(i[e.stat_consumption])||0,d=(0,l.hZ)(t,s);if(a.push({id:t,value:[n,e.stat_consumption],itemStyle:{color:d+"7F",borderColor:d}}),o){const i=e.stat_consumption in o&&(0,v.Kj)(o[e.stat_consumption])||0;r.push({id:t,value:[i,e.stat_consumption],itemStyle:{color:d+"32",borderColor:d+"7F"}})}})),a.sort(((e,t)=>t.value[0]-e.value[0])),a.length=(null===(t=this._config)||void 0===t?void 0:t.max_devices)||a.length,this._chartData=n,await this.updateComplete}},{kind:"method",key:"_handleChartClick",value:function(e){"axisLabel"===e.detail.targetType&&e.detail.value&&!(0,v.Hs)(e.detail.value)&&(0,y.B)(this,"hass-more-info",{entityId:e.detail.value})}},{kind:"field",static:!0,key:"styles",value(){return(0,r.iv)(b||(b=_`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}ha-chart-base{--chart-max-height:none}`))}}]}}),(0,f.f)(r.oi));o()}catch(g){o(g)}}))},94134:function(e,t,i){i.d(t,{V:()=>o});i(19134),i(5740);const o=/Mac/i.test(navigator.userAgent)},32424:function(e,t,i){i.d(t,{E:()=>r});var o=i(53907),a=i(18112);function r(e,t,i){const r=(0,a.Q)(e,null==i?void 0:i.in);return isNaN(t)?(0,o.L)((null==i?void 0:i.in)||e,NaN):t?(r.setDate(r.getDate()+t),r):r}},38836:function(e,t,i){i.d(t,{T:()=>r});var o=i(23711),a=i(76808);function r(e,t,i){return(0,o.n)(e,t*a.vh,i)}},23711:function(e,t,i){i.d(t,{n:()=>r});var o=i(53907),a=i(18112);function r(e,t,i){return(0,o.L)((null==i?void 0:i.in)||e,+(0,a.Q)(e)+t)}},23459:function(e,t,i){i.d(t,{z:()=>r});var o=i(53907),a=i(18112);function r(e,t,i){const r=(0,a.Q)(e,null==i?void 0:i.in);if(isNaN(t))return(0,o.L)((null==i?void 0:i.in)||e,NaN);if(!t)return r;const n=r.getDate(),s=(0,o.L)((null==i?void 0:i.in)||e,r.getTime());s.setMonth(r.getMonth()+t+1,0);return n>=s.getDate()?s:(r.setFullYear(s.getFullYear(),s.getMonth(),n),r)}},14276:function(e,t,i){i.d(t,{_:()=>a});var o=i(18112);function a(e,t){return+(0,o.Q)(e)-+(0,o.Q)(t)}},71185:function(e,t,i){i.d(t,{d:()=>d});i(71695),i(47021);var o=i(18492),a=i(18112);function r(e,t){const i=+(0,a.Q)(e)-+(0,a.Q)(t);return i<0?-1:i>0?1:i}function n(e,t,i){const[a,r]=(0,o.d)(null==i?void 0:i.in,e,t);return 12*(a.getFullYear()-r.getFullYear())+(a.getMonth()-r.getMonth())}var s=i(3938);function d(e,t,i){const[a,d,l]=(0,o.d)(null==i?void 0:i.in,e,e,t),c=r(d,l),h=Math.abs(n(d,l));if(h<1)return 0;1===d.getMonth()&&d.getDate()>27&&d.setDate(30),d.setMonth(d.getMonth()-c*h);let u=r(d,l)===-c;(0,s.h)(a)&&1===h&&1===r(a,l)&&(u=!1);const v=c*(h-+u);return 0===v?0:v}},96500:function(e,t,i){i.d(t,{i:()=>a});var o=i(18112);function a(e,t){const i=(0,o.Q)(e,null==t?void 0:t.in);return i.setHours(23,59,59,999),i}},2621:function(e,t,i){i.d(t,{V:()=>a});var o=i(18112);function a(e,t){const i=(0,o.Q)(e,null==t?void 0:t.in),a=i.getMonth();return i.setFullYear(i.getFullYear(),a+1,0),i.setHours(23,59,59,999),i}},86319:function(e,t,i){i.d(t,{b:()=>a});var o=i(18112);function a(e,t){return 1===(0,o.Q)(e,null==t?void 0:t.in).getDate()}},3938:function(e,t,i){i.d(t,{h:()=>n});var o=i(96500),a=i(2621),r=i(18112);function n(e,t){const i=(0,r.Q)(e,null==t?void 0:t.in);return+(0,o.i)(i,t)==+(0,a.V)(i,t)}}}]);
//# sourceMappingURL=79542.cc0a4896624b4d22.js.map