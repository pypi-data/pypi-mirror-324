

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Shcok Analysis &mdash; MARIO 0.3.5 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Transforming a SUT table from Isard to Chenery-Moses model" href="../tutorial_transformation_isard_to_chenery/tutorial_transformation_isard_to_chenery.html" />
    <link rel="prev" title="Adding satellite accounts" href="../tutorial_add_extensions/tutorial_add_extensions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MARIO
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">MARIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#quickstart">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#citation">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#read-more">Read more</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../settings.html">Changing mario settings</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorial_data_template/tutorial_data_template.html">Creating an Empty Database, from tabular information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_add_extensions/tutorial_add_extensions.html">Adding satellite accounts</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Shcok Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#shock-implementation-using-python-script">Shock implementation using python script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementing-a-shock-using-mario-excel-platform">Implementing a shock using mario excel platform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#defining-the-clusters">Defining the Clusters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_transformation_isard_to_chenery/tutorial_transformation_isard_to_chenery.html">Transforming a SUT table from Isard to Chenery-Moses model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_transformation_sut_to_iot/tutorial_transformation_sut_to_iot.html">Transforming a SUT into an IOT table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_figaro_parser/tutorial_figaro_parser.html">Figaro Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_parse_eora/tutorial_parse_eora.html">Parsing EORA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_parse_exiobase_hybrid/tutorial_parse_exiobase_hybrid.html">Parsing Exiobase v3.3.18 (supply-use hybrid-units)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_parse_exiobase_monetary/tutorial_parse_exiobase_monetary.html">Parsing Exiobase v3.8.2 (Monetary units)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_parse_custom_database/tutorial_parse_custom_database.html">Parsing custom database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_hand_shakes/tutorial_hand_shakes.html">Using MARIO and Pymrio Handshake Protocols</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_refernces.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MARIO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../examples.html">Examples</a> &raquo;</li>
        
      <li>Shcok Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/examples/tutorial_shock_analysis/tutorial_shock_analysis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="shcok-analysis">
<h1>Shcok Analysis<a class="headerlink" href="#shcok-analysis" title="Permalink to this headline">¶</a></h1>
<p>A scenario can be implemented in multiple ways within mario.</p>
<div class="section" id="shock-implementation-using-python-script">
<h2>Shock implementation using python script<a class="headerlink" href="#shock-implementation-using-python-script" title="Permalink to this headline">¶</a></h2>
<p>In this approach, you need to use the pandas functions properly to
implement changes in your database, and update the matrices in mario
scenario accordingly. Lets load the test example to see how it works.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mario</span> <span class="kn">import</span> <span class="n">load_test</span><span class="p">,</span><span class="n">slicer</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">load_test</span><span class="p">(</span><span class="s2">&quot;IOT&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s assume you want to model a final demand increase scenario in your
database. The first step would be to clone a new scneario from baseline
data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">clone_scenario</span><span class="p">(</span>
    <span class="n">scenario</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="c1"># from which scenario clone</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Final demand increase&#39;</span><span class="p">,</span><span class="c1"># what will be the name of the new scenario</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">scenarios</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;Final demand increase&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now lets assume you want to increase the local final demand of
agriculture sectors in Italy by 10%. This is how the matrix of final
demand (Y) looks like:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">Y</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>Region</th>
      <th>Italy</th>
      <th>RoW</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>Level</th>
      <th>Consumption category</th>
      <th>Consumption category</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>Item</th>
      <th>Final Demand</th>
      <th>Final Demand</th>
    </tr>
    <tr>
      <th>Region</th>
      <th>Level</th>
      <th>Item</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">Italy</th>
      <th rowspan="6" valign="top">Sector</th>
      <th>Agriculture</th>
      <td>2.843471e+04</td>
      <td>4.875449e+03</td>
    </tr>
    <tr>
      <th>Construction</th>
      <td>1.447732e+05</td>
      <td>4.655076e+02</td>
    </tr>
    <tr>
      <th>Manufacturing</th>
      <td>2.998989e+05</td>
      <td>2.316510e+05</td>
    </tr>
    <tr>
      <th>Mining</th>
      <td>9.219922e+02</td>
      <td>2.023559e+02</td>
    </tr>
    <tr>
      <th>Services</th>
      <td>1.052847e+06</td>
      <td>5.080214e+04</td>
    </tr>
    <tr>
      <th>Transport</th>
      <td>5.738525e+04</td>
      <td>5.686902e+03</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">RoW</th>
      <th rowspan="6" valign="top">Sector</th>
      <th>Agriculture</th>
      <td>1.099317e+04</td>
      <td>2.073065e+06</td>
    </tr>
    <tr>
      <th>Construction</th>
      <td>1.072044e+03</td>
      <td>1.059925e+07</td>
    </tr>
    <tr>
      <th>Manufacturing</th>
      <td>1.217507e+05</td>
      <td>1.816087e+07</td>
    </tr>
    <tr>
      <th>Mining</th>
      <td>4.621724e+02</td>
      <td>4.603934e+05</td>
    </tr>
    <tr>
      <th>Services</th>
      <td>4.307168e+04</td>
      <td>4.842609e+07</td>
    </tr>
    <tr>
      <th>Transport</th>
      <td>8.726021e+03</td>
      <td>3.100367e+06</td>
    </tr>
  </tbody>
</table>
</div><p>So you need to slice the database properly to increase the total final
demand of agriculture sector in Italy. For easier use, you can use mario
slicer function in case you dont want to deal with slicing of pandas
through loc function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_rows</span> <span class="o">=</span> <span class="n">slicer</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">Region</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Italy&#39;</span><span class="p">],</span><span class="n">Item</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Agriculture&#39;</span><span class="p">])</span>
<span class="n">Y_cols</span> <span class="o">=</span> <span class="n">slicer</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Region</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Italy&#39;</span><span class="p">],</span><span class="n">Item</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Final Demand&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Now you can increase the specific value by 10% as:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_new</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="n">matrices</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="n">scenarios</span><span class="o">=</span><span class="s2">&quot;Final demand increase&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_new</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Y_rows</span><span class="p">,</span><span class="n">Y_cols</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.1</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Baseline Y&quot;</span><span class="p">,</span><span class="n">test</span><span class="o">.</span><span class="n">Y</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Y_rows</span><span class="p">,</span><span class="n">Y_cols</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scenario Y&quot;</span><span class="p">,</span><span class="n">Y_new</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Y_rows</span><span class="p">,</span><span class="n">Y_cols</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Baseline</span> <span class="n">Y</span> <span class="n">Region</span>                                   <span class="n">Italy</span>
<span class="n">Level</span>                     <span class="n">Consumption</span> <span class="n">category</span>
<span class="n">Item</span>                              <span class="n">Final</span> <span class="n">Demand</span>
<span class="n">Region</span> <span class="n">Level</span>  <span class="n">Item</span>
<span class="n">Italy</span>  <span class="n">Sector</span> <span class="n">Agriculture</span>         <span class="mf">28434.707841</span>
<span class="n">Scenario</span> <span class="n">Y</span> <span class="n">Region</span>                                   <span class="n">Italy</span>
<span class="n">Level</span>                     <span class="n">Consumption</span> <span class="n">category</span>
<span class="n">Item</span>                              <span class="n">Final</span> <span class="n">Demand</span>
<span class="n">Region</span> <span class="n">Level</span>  <span class="n">Item</span>
<span class="n">Italy</span>  <span class="n">Sector</span> <span class="n">Agriculture</span>         <span class="mf">31278.178625</span>
</pre></div>
</div>
<p>Now you need to update the scenario data then reset all the matrices of
scenario to coefficients only (as they are not changed!), to recaulcuate
the matrices again.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">update_scenarios</span><span class="p">(</span><span class="n">scenario</span><span class="o">=</span><span class="s1">&#39;Final demand increase&#39;</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="n">Y_new</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">reset_to_coefficients</span><span class="p">(</span><span class="n">scenario</span><span class="o">=</span><span class="s1">&#39;Final demand increase&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Lets take a look to a graph to see how things look like:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change in total production</span>
<span class="n">delta_X</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="n">matrices</span> <span class="o">=</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="c1"># which matrix</span>
    <span class="n">scenarios</span> <span class="o">=</span> <span class="s2">&quot;Final demand increase&quot;</span><span class="p">,</span> <span class="c1"># take the new scenario</span>
    <span class="n">base_scenario</span><span class="o">=</span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span> <span class="c1"># take the base scenario</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;absolute&quot;</span> <span class="c1"># calcualte the absolute changes</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta_X</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>production</th>
    </tr>
    <tr>
      <th>Region</th>
      <th>Level</th>
      <th>Item</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">Italy</th>
      <th rowspan="6" valign="top">Sector</th>
      <th>Agriculture</th>
      <td>2961.338965</td>
    </tr>
    <tr>
      <th>Construction</th>
      <td>57.329630</td>
    </tr>
    <tr>
      <th>Manufacturing</th>
      <td>597.267115</td>
    </tr>
    <tr>
      <th>Mining</th>
      <td>6.332699</td>
    </tr>
    <tr>
      <th>Services</th>
      <td>745.379267</td>
    </tr>
    <tr>
      <th>Transport</th>
      <td>185.686254</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">RoW</th>
      <th rowspan="6" valign="top">Sector</th>
      <th>Agriculture</th>
      <td>121.156060</td>
    </tr>
    <tr>
      <th>Construction</th>
      <td>5.421589</td>
    </tr>
    <tr>
      <th>Manufacturing</th>
      <td>302.857308</td>
    </tr>
    <tr>
      <th>Mining</th>
      <td>45.949173</td>
    </tr>
    <tr>
      <th>Services</th>
      <td>193.241123</td>
    </tr>
    <tr>
      <th>Transport</th>
      <td>36.432992</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta_X</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Axes</span><span class="p">:</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Region,Level,Item&#39;</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../_images/output_20_1.png" src="../../_images/output_20_1.png" />
</div>
<div class="section" id="implementing-a-shock-using-mario-excel-platform">
<h2>Implementing a shock using mario excel platform<a class="headerlink" href="#implementing-a-shock-using-mario-excel-platform" title="Permalink to this headline">¶</a></h2>
<p>mario also supports introduction of very complex shocks through an excel
platform, which can be generated with mario automatically based on the
shape of the database. Then scenarios can be translated with the options
of the excel files.</p>
<p>The excel platform alos gives the opprotunity to define cluseters of
sets like Region, Secotr,…. to implement more complex shocks.</p>
<p>Lets implement a different shock, by first loading a fresh test example.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">load_test</span><span class="p">(</span><span class="s2">&quot;IOT&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can ask mario to generate an excel file where you can fill your
shocks!</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">save_path</span> <span class="o">=</span> <span class="s2">&quot;shock_iot.xlsx&quot;</span>
<span class="n">test</span><span class="o">.</span><span class="n">get_shock_excel</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">save_path</span><span class="p">)</span>
</pre></div>
</div>
<p>An excel file will be created in the given path. The excel file has 6
different pages as follow:</p>
<ol class="arabic simple">
<li><p>indeces: this page contains all the valid data that can be used for
the definition of the shocks. These values are used to validate the
data on other sheets</p></li>
<li><p>main: This sheet is an optional sheet that user may use for the
intermediate calculations and defining the assumptions of the problem</p></li>
<li><p>Y: This sheet is specified for implementing a shock on the Final
demand</p></li>
<li><p>v: This sheet is specified for implementing a shock on tha value
added</p></li>
<li><p>e: This sheet is specified for implementing a shock on the satellite
account</p></li>
<li><p>z: This sheet is specified for implementing a shock on the
intersectoral transaction matrix</p></li>
</ol>
<p>In this version of mario, there are different ways to implement a shock
(more options will be added to the next versions):</p>
<ol class="arabic simple">
<li><p>update: this method updates a value on the coefficient matrix</p></li>
<li><p>Absolute: this method implements the change in terms of absolute
values (flows) and implement the change on coefficient matrix</p></li>
<li><p>Percentage: this method implements a percentage change directly on
coefficient matrix (the values should be between 0 to 1 meaning that
10% increase is 0.1 and 10% decrease is -0.1)</p></li>
</ol>
<p>For example, a scenario with 10% increase in the self consumption of
services sector in Italy can be modeled in the excel file as follow:</p>
<div class="figure align-default" id="id1">
<img alt="Alt text" src="../../_images/shock_z.png" />
<p class="caption"><span class="caption-text">Alt text</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>Let’s assume that we fill the excel file, and call it
shock_iot_filled.xlsx. To implement the shock, you can:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">shock_calc</span><span class="p">(</span>
    <span class="n">io</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;shock_iot_filled.xlsx&#39;</span><span class="p">,</span> <span class="c1"># Path to the excel file</span>
    <span class="n">z</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="c1"># the shock will be implemented on z</span>
    <span class="n">notes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;you may add some notes for metadata&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">scenarios</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;shock 1&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>If you dont choose a name for your shock, mario will do it for you!</p>
<div class="section" id="defining-the-clusters">
<h3>Defining the Clusters<a class="headerlink" href="#defining-the-clusters" title="Permalink to this headline">¶</a></h3>
<p>In order to impelemnt shocks on a bunch of items, you can use clusters.
Lets implement a change in the local final demand of all sectors in
italy for 10%, first without the clusters.</p>
<p>In this way, user needs to replicate the same change for all the sectros
in italy as shown in the picture</p>
<div class="figure align-default" id="id2">
<img alt="Alt text" src="../../_images/no_cluster.png" />
<p class="caption"><span class="caption-text">Alt text</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>n easier way to this shock is to use clusters. In this case user needs
to define a cluster on the ‘Sector’. But clusters can be defined on all
the sets of the table (for checking all the sets of table you can use
test.sets)</p>
<p>A cluster on sectors can be defined as follow:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clusters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Sector&#39;</span><span class="p">:</span> <span class="c1"># Cluster on which set</span>
                    <span class="p">{</span><span class="s1">&#39;All&#39;</span><span class="p">:</span> <span class="n">test</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="s1">&#39;Sector&#39;</span><span class="p">)</span>    <span class="c1"># what is the name of the cluster and what it contains</span>
                    <span class="p">}</span>
           <span class="p">}</span>
</pre></div>
</div>
<p>So in this case, we are making a cluster on Sector. The cluster will be
called All and it contains all the Sectors in the database. Now if we
request mario to generate the shock excel, ‘All’ is added as a valid
option for the Sector.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">save_path</span> <span class="o">=</span> <span class="s1">&#39;shock_iot_cluster.xlsx&#39;</span>
<span class="n">test</span><span class="o">.</span><span class="n">get_shock_excel</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">save_path</span><span class="p">,</span><span class="o">**</span><span class="n">clusters</span><span class="p">)</span>
</pre></div>
</div>
<p>The same shock now can be implemented as the shown in the pic:</p>
<div class="figure align-default" id="id3">
<img alt="Alt text" src="../../_images/cluster.png" />
<p class="caption"><span class="caption-text">Alt text</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>In order to implement a shock, we need to use the excel files and the
definition of clusters as follow. Let’s assume we call the filled excel
file as shock_iot_cluster_filled.xlsx:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">shock_calc</span><span class="p">(</span>
    <span class="n">io</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;shock_iot_cluster_filled.xlsx&#39;</span><span class="p">,</span> <span class="c1"># Path to the excel file</span>
    <span class="n">Y</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="c1"># the shock will be implemented on Y</span>
    <span class="o">**</span><span class="n">clusters</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">scenarios</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;shock 1&#39;</span><span class="p">,</span> <span class="s1">&#39;shock 2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Just to understand what is happening behind the scene, you can take a
look to the metadata history:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">meta_history</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">18</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span>    <span class="n">Table</span> <span class="n">added</span> <span class="n">into</span> <span class="n">metadata</span> <span class="k">with</span> <span class="n">value</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">IOT</span><span class="o">.</span>
<span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">18</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span>    <span class="n">Price</span> <span class="n">added</span> <span class="n">into</span> <span class="n">metadata</span> <span class="k">with</span> <span class="n">value</span> <span class="n">equal</span> <span class="n">to</span> <span class="kc">None</span><span class="o">.</span>
<span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">18</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span>    <span class="n">Source</span> <span class="n">added</span> <span class="n">into</span> <span class="n">metadata</span> <span class="k">with</span> <span class="n">value</span> <span class="n">equal</span> <span class="n">to</span> <span class="kc">None</span><span class="o">.</span>
<span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">18</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span>    <span class="n">Year</span> <span class="n">added</span> <span class="n">into</span> <span class="n">metadata</span> <span class="k">with</span> <span class="n">value</span> <span class="n">equal</span> <span class="n">to</span> <span class="kc">None</span><span class="o">.</span>
<span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">18</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span>    <span class="n">Shocks</span> <span class="n">implemented</span> <span class="kn">from</span> <span class="nn">shock_iot_filled.xlsx</span> <span class="k">as</span> <span class="n">follow</span><span class="p">:</span>
<span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">18</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span>    <span class="n">Shock</span> <span class="p">(</span><span class="n">Notes</span><span class="p">):</span> <span class="n">you</span> <span class="n">may</span> <span class="n">add</span> <span class="n">some</span> <span class="n">notes</span> <span class="k">for</span> <span class="n">metadata</span>
<span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">18</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span>    <span class="n">Shock</span> <span class="n">on</span> <span class="n">z</span> <span class="n">implemented</span><span class="p">:</span> <span class="n">row_region_</span><span class="p">:</span><span class="n">Italy</span><span class="p">,</span> <span class="n">row_level_</span><span class="p">:</span><span class="n">Sector</span><span class="p">,</span> <span class="n">row_sector_</span><span class="p">:</span><span class="n">Services</span><span class="p">,</span> <span class="n">column_region_</span><span class="p">:</span><span class="n">Italy</span><span class="p">,</span> <span class="n">column_level_</span><span class="p">:</span><span class="n">Sector</span> <span class="n">column_sector_</span><span class="p">:</span><span class="n">Services</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="n">Percentage</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="mf">0.1</span><span class="o">.</span>
<span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">18</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span>    <span class="n">Shocks</span> <span class="n">implemented</span> <span class="kn">from</span> <span class="nn">shock_iot_cluster_filled.xlsx</span> <span class="k">as</span> <span class="n">follow</span><span class="p">:</span>
<span class="p">[</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">18</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">48</span><span class="p">]</span>    <span class="n">Shock</span> <span class="n">on</span> <span class="n">Y</span> <span class="n">implemented</span><span class="p">:</span> <span class="n">row_region</span><span class="p">:</span><span class="n">Italy</span><span class="p">,</span> <span class="n">row_level</span><span class="p">:</span><span class="n">Sector</span><span class="p">,</span> <span class="n">row_sector</span><span class="p">:[</span><span class="s1">&#39;Agriculture&#39;</span><span class="p">,</span> <span class="s1">&#39;Mining&#39;</span><span class="p">,</span> <span class="s1">&#39;Manufacturing&#39;</span><span class="p">,</span> <span class="s1">&#39;Services&#39;</span><span class="p">,</span> <span class="s1">&#39;Construction&#39;</span><span class="p">,</span> <span class="s1">&#39;Transport&#39;</span><span class="p">],</span> <span class="n">column_region</span><span class="p">:</span><span class="n">Italy</span><span class="p">,</span> <span class="n">demand_category</span><span class="p">:</span> <span class="n">Final</span> <span class="n">Demand</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="n">Percentage</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="mf">0.1</span><span class="o">.</span>
</pre></div>
</div>
<p><code class="xref download docutils literal notranslate"><span class="pre">Link</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">jupyter</span> <span class="pre">notebook</span> <span class="pre">file</span></code>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../tutorial_transformation_isard_to_chenery/tutorial_transformation_isard_to_chenery.html" class="btn btn-neutral float-right" title="Transforming a SUT table from Isard to Chenery-Moses model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../tutorial_add_extensions/tutorial_add_extensions.html" class="btn btn-neutral float-left" title="Adding satellite accounts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, MARIO Authors: Mohammad Amin Tahavori, Lorenzo Rinaldi, Nicolo Golinucci.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>