FROM python:{{ image_version  }}

RUN apt-get update && apt-get install -y \
    build-essential \
    libpq-dev \
    {{ additional_system_packages | join(' ') if additional_system_packages else '' }} \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /app

COPY . /app

RUN pip install --no-cache-dir -r requirements.txt

EXPOSE {{ port }}


CMD ["{{ app_command | default('python') }}", "manage-server", "0.0.0.0:{{ port }}", "{{ django_wsgi | default('myproject.wsgi:application') }}"]
